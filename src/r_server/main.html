<!DOCTYPE html>
<html>
<head>
	<title>Groovy Robot</title>
	<style>
		img {
			max-width: 100%;
			height: auto;
		}
		body {
		  background: url(/images/wall-e.jpg) no-repeat;
		  background-size: 100%;
		}
	</style>
	<script type="text/javascript">
        'use strict'

        var ws = new WebSocket('ws://{{ host }}/ws');
        ws.onopen = function () {
            ws.send('hello');
        };
        ws.onmessage = function (evt) {
            console.log(evt.data);
        };

		var sendKey = (key) => {
			if (keyName === 'w' || keyName === 'ArrowUp') {
                ws.send('w');
            }
            else if (keyName === 's' || keyName === 'ArrowDown') {
                ws.send('s');
            }
            else if (keyName === 'a' || keyName === 'ArrowLeft') {
                ws.send('a');
            }
            else if (keyName === 'd' || keyName === 'ArrowRight') {
                ws.send('d');
            } else {
                ws.send(keyName)
            }
		};

		var keydownHandler = (event) => {
            const keyName = event.key.toLowerCase();

            console.log('down: ' + keyName)

			sendKey(keyName)
        };

		var keyupHandler = (event) => {
            const keyName = event.key.toUpperCase();

            console.log('up: ' + keyName)

            sendKey(keyName)

        };

        document.addEventListener('keydown', keydownHandler, false);
        document.addEventListener('keyup', keyupHandler, false);
	</script>
</head>
<body>
</body>
</html>
