<!DOCTYPE html>
<html>
<head>
    <title>Groovy Robot</title>
    <style>
    img {
        max-width: 100%;
        height: auto;
    }
    </style>
    <script type="text/javascript">
        'use strict'

        var ws = new WebSocket('ws://{{ host }}/ws');
        ws.onopen = function () {
            ws.send('hello');
        };
        ws.onmessage = function (evt) {
            console.log(evt.data);
        };

		var keydownHandler = (event) => {
            const keyName = event.key;

            console.log('down: ' + keyName);

            if (keyName === 'w' || keyName === 'ArrowUp') {
                ws.send('w');
            }
            else if (keyName === 's' || keyName === 'ArrowDown') {
                ws.send('s');
            }
            else if (keyName === 'a' || keyName === 'ArrowLeft') {
                ws.send('a');
            }
            else if (keyName === 'd' || keyName === 'ArrowRight') {
                ws.send('d');
            }
        };

		var keyupHandler = (event) => {
            const keyName = event.key;

            console.log('up: ' + keyName);

            ws.send('st');

        };

        document.addEventListener('keydown', keydownHandler, false);
        document.addEventListener('keyup', keyupHandler, false);

		document.getElementById('box').addEventListener('keydown', keydownHandler);
		document.getElementById('box').addEventListener('keyup', keydupHandler);

    </script>
</head>
<body>
    <img src="images/wall-e.jpg" />
	<input id="box" type="text" />
</body>
</html>
